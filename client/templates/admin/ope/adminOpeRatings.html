<template name="adminOpeRatings">
    <div class="row">
        <div class="col-md-12">
            <h4 style="text-align: center; padding-bottom: 15pt">OPE Рейтинг</h4>
            
            <div class="row">
                <div class="col-md-12">
                    <div class="form-inline">
                        <div class="form-group" style="margin-right: 15pt">
                        {{> academicYear}}

                        <label for="" style="margin-left: 10pt; ">Пән</label>
                        <select class="form-control" id="subjectId">
                            <option value="all">Жалпы</option>
                            <option value="01">Алгебра</option>
                            <option value="02">Физика</option>
                            <option value="03">Химия</option>
                            <option value="04">Биология</option>
                            <option value="05">Ағылшын тілі</option>
                            <option value="06">География</option>
                            <option value="08">Информатика</option>
                            <option value="09">Қазақ тілі</option>
                            <option value="10">Түрік тілі</option>
                            <option value="11">Орыс тілі</option>
                            <option value="12">Қазақстан тарихы</option>
                            <option value="15">Құқық</option>
                        </select>

                        <label for="" style="margin-left: 10pt; ">Сынып</label>
                        <select class="form-control" id="grade">
                            <option value="all">Жалпы</option>
                            <option value="7">7 сынып</option>
                            <option value="8">8 сынып</option>
                            <option value="9">9 сынып</option>
                            <option value="10">10 сынып</option>
                            <option value="11">11 сынып</option>
                        </select>

                        <label for="" style="margin-left: 10pt; ">Рейтинг түрі</label>
                        <select class="form-control" id="rating_type">
                            <option value="average">Орташа</option>
                            <option value="percentageRegion">"Область" дәлелденген пайыз</option>
                            <option value="percentageRepublic">"Республика" дәлелденген пайыз</option>
                            <option value="quantityRegion">"Область" дәлелденген саны</option>
                            <option value="quantityRepublic">"Республика" дәлелденген саны</option>
                            <option value="percentageBoth">Жалпы дәлелденген пайыз</option>
                            <option value="quantityBoth">Жалпы дәлелденген саны</option>
                        </select>

                        <label for="threshold_regional" style="margin-left: 10pt;"><span style="padding: 5px; background-color: #ccffff">Область</span></label>
                        <!-- <input type="text" style="width: 40pt" id="threshold_region" class="form-control" placeholder="Сан енгізіңіз" name="threshold_regional" value="{{opeThresholds 'region'}}">                         -->
                        <span>{{#if opeThresholds 'region'}}{{opeThresholds 'region'}}{{else}}-{{/if}}</span>

                        <label for="threshold_republic" style="margin-left: 10pt;"><span style="padding: 5px; background-color: #cce5ff">Республика</span></label>
                        <!-- <input type="text" style="width: 40pt" id="threshold_republic" class="form-control" placeholder="Сан енгізіңіз" name="threshold_republic" value="{{opeThresholds 'republic'}}"> -->
                        <span>{{#if opeThresholds 'republic'}}{{opeThresholds 'republic'}}{{else}}-{{/if}}</span>


                        </div>
                        
                        <div class="form-group" style="float: right">
                            <a class="btn btn-success" id="download">Download</a>
                        </div>
                    </div>
                </div>
            </div>

            {{#if Template.subscriptionsReady}}

            <table style="margin-top: 15pt" class="table table-striped">
                <thead>
                    <tr class="bts-header">
                        <th>#</th>
                        <th>Мектеп</th>
                        <th id='ope1' style="text-align: center">
                            <!-- OPE<br>16.11 - 30.11 -->
                            OPE-1
                        </th>
                        <th id='ope2' style="text-align: center">
                            <!-- OPE<br>30.11 - 14.12 -->
                            OPE-2
                        </th>
                        <th id='ope3' style="text-align: center">
                            <!-- OPE<br>14.12 - 28.12 -->
                            OPE-3
                        </th>
                        <th id='ope4' style="text-align: center">
                            <!-- OPE<br>28.12 - 11.01 -->
                            OPE-4
                        </th>
                        <th id='ope5' style="text-align: center">
                            <!-- OPE<br>11.01 - 25.01 -->
                            OPE-5
                        </th>
                        <th id='ope6' style="text-align: center">
                            <!-- OPE<br>25.01 - 08.02 -->
                            OPE-6
                        </th>
                        <th id='opeAverage' style="text-align:center">Average</th>
                    </tr>
                </thead>
                <tbody>
                  {{#each schools}}

                    <tr>
                      <td>{{math @index "+" 1}}</td>
                      <td style="width:20%">{{shortName}}</td>

                        {{#if isAverage}}
                            {{#each (repeat 6)}}
                                <td style="text-align:center">{{getAverage this ../schoolId}}</td>
                            {{/each}}
                            <td style="text-align: center">{{averageAverages schoolId}}</td>
                        {{else}}
                            {{#if isPercentageRegion}}
                                {{#each (repeat 6)}}
                                    <td style="text-align:center">{{getPercentageRegion this ../schoolId}}</td>
                                {{/each}}
                                <td style="text-align: center">{{averagePercentagesRegion schoolId}}</td>
                            {{else}}
                                {{#if isPercentageRepublic}}
                                    {{#each (repeat 6)}}
                                        <td style="text-align:center">{{getPercentageRepublic this ../schoolId}}</td>
                                    {{/each}}
                                    <td style="text-align: center">{{averagePercentagesRepublic schoolId}}</td>
                                {{else}}
                                    {{#if isQuantityRegion}}
                                        {{#each (repeat 6)}}
                                            <td style="text-align:center">{{getQuantityRegion this ../schoolId}}</td>
                                        {{/each}}
                                        <td style="text-align: center">{{averageQuantitiesRegion schoolId}}</td>
                                    {{else}}
                                        {{#if isQuantityRepublic}}
                                            {{#each (repeat 6)}}
                                                <td style="text-align:center">{{getQuantityRepublic this ../schoolId}}</td>
                                            {{/each}}
                                            <td style="text-align: center">{{averageQuantitiesRepublic schoolId}}</td>
                                        {{else}}
                                            {{#if isPercentageBoth}}
                                                {{#each (repeat 6)}}
                                                    <td style="text-align:center">{{getPercentageBoth this ../schoolId}}</td>
                                                {{/each}}
                                                <td style="text-align: center">{{averagePercentagesBoth schoolId}}</td>
                                            {{else}}
                                                {{#if isQuantityBoth}}
                                                    {{#each (repeat 6)}}
                                                        <td style="text-align:center">{{getQuantityBoth this ../schoolId}}</td>
                                                    {{/each}}
                                                    <td style="text-align: center">{{averageQuantitiesBoth schoolId}}</td>
                                                {{/if}}
                                            {{/if}}
                                        {{/if}}
                                    {{/if}}
                                {{/if}}
                            {{/if}}
                        {{/if}}
                    </tr>
                  {{/each}}

                </tbody>
            </table>

            {{else}}
            <p>Loading...</p>
            {{/if}}
        </div>
    </div>
</template>
